<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>注册 - 知识图谱系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="static/css/auth.css">
</head>
<body>
<<!-- 新增两侧垂直打字动画 -->
    <div class="vertical-typing-container">
        <div class="typing-left" id="typingLeft"></div>
        <div class="typing-right" id="typingText"></div>
    </div>
    <div class="auth-container1">
        <div class="auth-card">
            <div class="auth-logo">
                <img src="https://via.placeholder.com/60x60" alt="系统Logo">
                <h3>创建新账号</h3>
                <p class="text-muted">加入知识图谱系统</p>
            </div>

            <form id="registerForm">
                <div class="alert alert-danger d-none" id="registerError"></div>

                <div class="form-group">
                    <label for="registerUsername" class="form-label">用户名</label>
                    <input type="text" id="registerUsername" class="form-control" placeholder="请输入用户名" required>
                    <div class="error-message d-none" id="registerUsernameError"></div>
                </div>

<!--                <div class="form-group">-->
<!--                    <label for="registerEmail" class="form-label">邮箱</label>-->
<!--                    <input type="email" id="registerEmail" class="form-control" placeholder="请输入邮箱" required>-->
<!--                    <div class="error-message d-none" id="registerEmailError"></div>-->
<!--                </div>-->

                <div class="form-group">
                    <label for="registerPassword" class="form-label">密码</label>
                    <input type="password" id="registerPassword" class="form-control" placeholder="请输入密码" required>
                    <div class="error-message d-none" id="registerPasswordError"></div>
                </div>

                <div class="form-group">
                    <label for="registerPasswordConfirm" class="form-label">确认密码</label>
                    <input type="password" id="registerPasswordConfirm" class="form-control" placeholder="请再次输入密码" required>
                    <div class="error-message d-none" id="registerPasswordConfirmError"></div>
                </div>

                <div class="form-group form-check">
                    <input type="checkbox" class="form-check-input" id="acceptTerms" required>
                    <label class="form-check-label" for="acceptTerms">
                        我已阅读并同意<a href="#" class="text-decoration-none">服务条款</a>和<a href="#" class="text-decoration-none">隐私政策</a>
                    </label>
                </div>

                <div class="text-center">
                    <button type="submit" class="btn btn-success auth-btn">注册</button>
                </div>


                <div class="auth-footer">
                    <p class="text-center mt-3">
                        已有账号? <a href="login.html" class="text-decoration-none">立即登录</a>
                    </p>
                </div>
            </form>
        </div>
    </div>

    <script>

        // 新增垂直打字动画脚本
        document.addEventListener('DOMContentLoaded', function() {
            const textLeft = "请 您 创 建";
            const textRight = "新 的 账 号";
            const typingLeftElement = document.getElementById('typingLeft');
            const typingRightElement = document.getElementById('typingText');

            // 垂直打字函数
            function typeVertical(element, text, speed, callback) {
                const lines = text.split('\n');
                let i = 0, j = 0;

                function typeLine() {
                    if (i < lines.length) {
                        if (j <= lines[i].length) {
                            element.innerHTML = lines.slice(0, i).join('<br>') +
                                              '<br>' + lines[i].substring(0, j);
                            j++;
                            setTimeout(typeLine, speed);
                        } else {
                            i++;
                            j = 0;
                            element.innerHTML = lines.slice(0, i).join('<br>');
                            if (i < lines.length) {
                                setTimeout(typeLine, speed * 2);
                            } else if (callback) {
                                callback();
                            }
                        }
                    }
                }
                typeLine();
            }

            // 先打左侧文字，再打右侧文字
            typeVertical(typingLeftElement, textLeft, 150, function() {
                setTimeout(() => {
                    typeVertical(typingRightElement, textRight, 150);
                }, 300);
            });
        });

        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // 清除错误状态
            document.getElementById('registerError').classList.add('d-none');
            document.getElementById('registerUsernameError').classList.add('d-none');
            document.getElementById('registerEmailError').classList.add('d-none');
            document.getElementById('registerPasswordError').classList.add('d-none');
            document.getElementById('registerPasswordConfirmError').classList.add('d-none');

            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const passwordConfirm = document.getElementById('registerPasswordConfirm').value;

            let isValid = true;
            const errors = [];

            if (!username.trim()) {
                document.getElementById('registerUsernameError').textContent = '请输入用户名';
                document.getElementById('registerUsernameError').classList.remove('d-none');
                isValid = false;
            } else if (username.length > 20) {
                document.getElementById('registerUsernameError').textContent = '用户名不能超过20个字符';
                document.getElementById('registerUsernameError').classList.remove('d-none');
                isValid = false;
            }

            if (!email) {
                document.getElementById('registerEmailError').textContent = '请输入邮箱';
                document.getElementById('registerEmailError').classList.remove('d-none');
                isValid = false;
            } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                document.getElementById('registerEmailError').textContent = '请输入有效的邮箱地址';
                document.getElementById('registerEmailError').classList.remove('d-none');
                isValid = false;
            }

            if (!password) {
                document.getElementById('registerPasswordError').textContent = '请输入密码';
                document.getElementById('registerPasswordError').classList.remove('d-none');
                isValid = false;
            } else if (password.length < 8) {
                document.getElementById('registerPasswordError').textContent = '密码长度至少为8位';
                document.getElementById('registerPasswordError').classList.remove('d-none');
                isValid = false;
            } else if (!/[A-Z]/.test(password)) {
                document.getElementById('registerPasswordError').textContent = '密码必须包含至少一个大写字母';
                document.getElementById('registerPasswordError').classList.remove('d-none');
                isValid = false;
            } else if (!/[0-9]/.test(password)) {
                document.getElementById('registerPasswordError').textContent = '密码必须包含至少一个数字';
                document.getElementById('registerPasswordError').classList.remove('d-none');
                isValid = false;
            }

            if (!passwordConfirm) {
                document.getElementById('registerPasswordConfirmError').textContent = '请确认密码';
                document.getElementById('registerPasswordConfirmError').classList.remove('d-none');
                isValid = false;
            } else if (password !== passwordConfirm) {
                document.getElementById('registerPasswordConfirmError').textContent = '两次输入的密码不一致';
                document.getElementById('registerPasswordConfirmError').classList.remove('d-none');
                isValid = false;
            }

            if (!document.getElementById('acceptTerms').checked) {
                errors.push('请接受服务条款和隐私政策');
                isValid = false;
            }

            if (isValid) {
                // 模拟注册成功
                console.log('注册信息:', { username, email, password });
                // 在实际应用中，这里会发送AJAX请求到后端
                // 注册成功后跳转到登录页面
                // window.location.href = 'login.html';

                // 模拟注册失败（用于演示）
                document.getElementById('registerError').textContent = '注册失败，请稍后重试';
                document.getElementById('registerError').classList.remove('d-none');
            } else if (errors.length > 0) {
                document.getElementById('registerError').textContent = errors.join('; ');
                document.getElementById('registerError').classList.remove('d-none');
            }
        });
    </script>
</body>
</html>